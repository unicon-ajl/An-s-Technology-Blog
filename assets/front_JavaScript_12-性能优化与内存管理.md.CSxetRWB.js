import{_ as i,c as a,o as l,ah as n}from"./chunks/framework.GQ0CnO8R.js";const g=JSON.parse('{"title":"æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç†","description":"","frontmatter":{},"headers":[{"level":1,"title":"æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç†","slug":"æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç†","link":"#æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç†","children":[{"level":2,"title":"ä¸€ã€æ€§èƒ½ç“¶é¢ˆçš„å¸¸è§æ¥æº","slug":"ä¸€ã€æ€§èƒ½ç“¶é¢ˆçš„å¸¸è§æ¥æº","link":"#ä¸€ã€æ€§èƒ½ç“¶é¢ˆçš„å¸¸è§æ¥æº","children":[]},{"level":2,"title":"äºŒã€å…³é”®æ€§èƒ½å·¥å…·ï¼ˆæµè§ˆå™¨ DevToolsï¼‰","slug":"äºŒã€å…³é”®æ€§èƒ½å·¥å…·-æµè§ˆå™¨-devtools","link":"#äºŒã€å…³é”®æ€§èƒ½å·¥å…·-æµè§ˆå™¨-devtools","children":[{"level":3,"title":"1. Performance é¢æ¿","slug":"_1-performance-é¢æ¿","link":"#_1-performance-é¢æ¿","children":[]},{"level":3,"title":"2. Memory é¢æ¿","slug":"_2-memory-é¢æ¿","link":"#_2-memory-é¢æ¿","children":[]},{"level":3,"title":"3. Lighthouse","slug":"_3-lighthouse","link":"#_3-lighthouse","children":[]}]},{"level":2,"title":"ä¸‰ã€å†…å­˜æ³„æ¼çš„å››å¤§ç»å…¸åœºæ™¯","slug":"ä¸‰ã€å†…å­˜æ³„æ¼çš„å››å¤§ç»å…¸åœºæ™¯","link":"#ä¸‰ã€å†…å­˜æ³„æ¼çš„å››å¤§ç»å…¸åœºæ™¯","children":[{"level":3,"title":"1. æœªæ¸…ç†çš„å®šæ—¶å™¨æˆ–å›è°ƒ","slug":"_1-æœªæ¸…ç†çš„å®šæ—¶å™¨æˆ–å›è°ƒ","link":"#_1-æœªæ¸…ç†çš„å®šæ—¶å™¨æˆ–å›è°ƒ","children":[]},{"level":3,"title":"2. æœªç§»é™¤çš„äº‹ä»¶ç›‘å¬å™¨","slug":"_2-æœªç§»é™¤çš„äº‹ä»¶ç›‘å¬å™¨","link":"#_2-æœªç§»é™¤çš„äº‹ä»¶ç›‘å¬å™¨","children":[]},{"level":3,"title":"3. å…¨å±€å˜é‡æˆ–æ¨¡å—ç¼“å­˜æ— é™å¢é•¿","slug":"_3-å…¨å±€å˜é‡æˆ–æ¨¡å—ç¼“å­˜æ— é™å¢é•¿","link":"#_3-å…¨å±€å˜é‡æˆ–æ¨¡å—ç¼“å­˜æ— é™å¢é•¿","children":[]},{"level":3,"title":"4. Detached DOM èŠ‚ç‚¹","slug":"_4-detached-dom-èŠ‚ç‚¹","link":"#_4-detached-dom-èŠ‚ç‚¹","children":[]}]},{"level":2,"title":"å››ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥","slug":"å››ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥","link":"#å››ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥","children":[{"level":3,"title":"1. å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œ","slug":"_1-å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œ","link":"#_1-å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œ","children":[]},{"level":3,"title":"2. é«˜æ•ˆ DOM æ“ä½œ","slug":"_2-é«˜æ•ˆ-dom-æ“ä½œ","link":"#_2-é«˜æ•ˆ-dom-æ“ä½œ","children":[]},{"level":3,"title":"3. æ‡’åŠ è½½ä¸ä»£ç åˆ†å‰²","slug":"_3-æ‡’åŠ è½½ä¸ä»£ç åˆ†å‰²","link":"#_3-æ‡’åŠ è½½ä¸ä»£ç åˆ†å‰²","children":[]},{"level":3,"title":"4. ç¼“å­˜ä¸å¤ç”¨","slug":"_4-ç¼“å­˜ä¸å¤ç”¨","link":"#_4-ç¼“å­˜ä¸å¤ç”¨","children":[]}]},{"level":2,"title":"äº”ã€åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æœºåˆ¶ç®€è¿°","slug":"äº”ã€åƒåœ¾å›æ”¶-gc-æœºåˆ¶ç®€è¿°","link":"#äº”ã€åƒåœ¾å›æ”¶-gc-æœºåˆ¶ç®€è¿°","children":[{"level":3,"title":"å¼±å¼•ç”¨ï¼šWeakMap / WeakSet","slug":"å¼±å¼•ç”¨-weakmap-weakset","link":"#å¼±å¼•ç”¨-weakmap-weakset","children":[]}]},{"level":2,"title":"å…­ã€é˜²æŠ–ï¼ˆDebounceï¼‰ä¸èŠ‚æµï¼ˆThrottleï¼‰","slug":"å…­ã€é˜²æŠ–-debounce-ä¸èŠ‚æµ-throttle","link":"#å…­ã€é˜²æŠ–-debounce-ä¸èŠ‚æµ-throttle","children":[{"level":3,"title":"é˜²æŠ–ï¼šé«˜é¢‘äº‹ä»¶åœæ­¢åæ‰æ‰§è¡Œ","slug":"é˜²æŠ–-é«˜é¢‘äº‹ä»¶åœæ­¢åæ‰æ‰§è¡Œ","link":"#é˜²æŠ–-é«˜é¢‘äº‹ä»¶åœæ­¢åæ‰æ‰§è¡Œ","children":[]},{"level":3,"title":"èŠ‚æµï¼šå›ºå®šé—´éš”æœ€å¤šæ‰§è¡Œä¸€æ¬¡","slug":"èŠ‚æµ-å›ºå®šé—´éš”æœ€å¤šæ‰§è¡Œä¸€æ¬¡","link":"#èŠ‚æµ-å›ºå®šé—´éš”æœ€å¤šæ‰§è¡Œä¸€æ¬¡","children":[]}]},{"level":2,"title":"æœ€ä½³å®è·µ","slug":"æœ€ä½³å®è·µ","link":"#æœ€ä½³å®è·µ","children":[]}]}],"relativePath":"front/JavaScript/12-æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç†.md","filePath":"front/JavaScript/12-æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç†.md","lastUpdated":1766568604000}'),h={name:"front/JavaScript/12-æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç†.md"};function t(e,s,k,p,r,d){return l(),a("div",null,[...s[0]||(s[0]=[n(`<h1 id="æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç†" tabindex="-1">æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç† <a class="header-anchor" href="#æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç†" aria-label="Permalink to â€œæ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜ç®¡ç†â€">â€‹</a></h1><blockquote><p>âš¡ <strong>å¿«ï¼Œæ˜¯ç”¨æˆ·ä½“éªŒçš„ç¬¬ä¸€é“é—¨æ§›ï¼›ç¨³ï¼Œæ˜¯é•¿æœŸè¿è¡Œçš„éšå½¢ä¿éšœ</strong>ã€‚<br> JavaScript è™½æœ‰è‡ªåŠ¨åƒåœ¾å›æ”¶ï¼Œä½†ä¸å½“ä½¿ç”¨ä»ä¼šå¯¼è‡´<strong>å†…å­˜æ³„æ¼ã€å¡é¡¿ã€å´©æºƒ</strong>ã€‚æŒæ¡æ€§èƒ½åˆ†æä¸å†…å­˜ç®¡ç†ï¼Œæ˜¯ä¸“ä¸šå¼€å‘è€…çš„å¿…ä¿®è¯¾ã€‚</p></blockquote><hr><h2 id="ä¸€ã€æ€§èƒ½ç“¶é¢ˆçš„å¸¸è§æ¥æº" tabindex="-1">ä¸€ã€æ€§èƒ½ç“¶é¢ˆçš„å¸¸è§æ¥æº <a class="header-anchor" href="#ä¸€ã€æ€§èƒ½ç“¶é¢ˆçš„å¸¸è§æ¥æº" aria-label="Permalink to â€œä¸€ã€æ€§èƒ½ç“¶é¢ˆçš„å¸¸è§æ¥æºâ€">â€‹</a></h2><table tabindex="0"><thead><tr><th>ç±»å‹</th><th>è¡¨ç°</th><th>å¸¸è§åŸå› </th></tr></thead><tbody><tr><td><strong>CPU å¯†é›†å‹</strong></td><td>é¡µé¢å¡é¡¿ã€åŠ¨ç”»æ‰å¸§</td><td>å¤æ‚è®¡ç®—ã€æ·±å±‚é€’å½’ã€æœªä¼˜åŒ–å¾ªç¯</td></tr><tr><td><strong>å†…å­˜æ³„æ¼</strong></td><td>å†…å­˜æŒç»­å¢é•¿ã€æœ€ç»ˆå´©æºƒ</td><td>æœªæ¸…ç†çš„å®šæ—¶å™¨ã€é—­åŒ…å¼•ç”¨ã€DOM æ³„æ¼</td></tr><tr><td><strong>æ¸²æŸ“é˜»å¡</strong></td><td>é¦–å±ç™½å±ã€äº¤äº’å»¶è¿Ÿ</td><td>åŒæ­¥è„šæœ¬ã€å¤§ä½“ç§¯ JSã€æœªæ‡’åŠ è½½</td></tr><tr><td><strong>I/O ç“¶é¢ˆ</strong></td><td>è¯·æ±‚æ…¢ã€æ•°æ®åŠ è½½ä¹…</td><td>æœªç¼“å­˜ã€æœªå¹¶è¡Œã€æœªå‹ç¼©</td></tr></tbody></table><blockquote><p>ğŸ” ä¼˜åŒ–å‰å…ˆ<strong>æµ‹é‡</strong>ï¼šç”¨ DevTools å®šä½çœŸå®ç“¶é¢ˆï¼Œé¿å…â€œè¿‡æ—©ä¼˜åŒ–â€ã€‚</p></blockquote><hr><h2 id="äºŒã€å…³é”®æ€§èƒ½å·¥å…·-æµè§ˆå™¨-devtools" tabindex="-1">äºŒã€å…³é”®æ€§èƒ½å·¥å…·ï¼ˆæµè§ˆå™¨ DevToolsï¼‰ <a class="header-anchor" href="#äºŒã€å…³é”®æ€§èƒ½å·¥å…·-æµè§ˆå™¨-devtools" aria-label="Permalink to â€œäºŒã€å…³é”®æ€§èƒ½å·¥å…·ï¼ˆæµè§ˆå™¨ DevToolsï¼‰â€">â€‹</a></h2><h3 id="_1-performance-é¢æ¿" tabindex="-1">1. <strong>Performance é¢æ¿</strong> <a class="header-anchor" href="#_1-performance-é¢æ¿" aria-label="Permalink to â€œ1. Performance é¢æ¿â€">â€‹</a></h3><ul><li>è®°å½•é¡µé¢åŠ è½½æˆ–äº¤äº’è¿‡ç¨‹ï¼›</li><li>åˆ†æ <strong>FPSã€CPU ä½¿ç”¨ç‡ã€ä¸»çº¿ç¨‹ä»»åŠ¡</strong>ï¼›</li><li>è¯†åˆ«é•¿ä»»åŠ¡ï¼ˆ&gt;50msï¼‰å’Œå¼ºåˆ¶åŒæ­¥å¸ƒå±€ï¼ˆLayout Thrashingï¼‰ã€‚</li></ul><p>âœ… ä½¿ç”¨æŠ€å·§ï¼š</p><ul><li>ç‚¹å‡» <strong>Record</strong> â†’ æ“ä½œé¡µé¢ â†’ åœæ­¢ï¼›</li><li>æŸ¥çœ‹ <strong>Main</strong> è½¨é“ä¸­çš„é»„è‰²ï¼ˆScriptï¼‰ã€ç´«è‰²ï¼ˆRenderï¼‰ã€ç»¿è‰²ï¼ˆPaintï¼‰å—ã€‚</li></ul><hr><h3 id="_2-memory-é¢æ¿" tabindex="-1">2. <strong>Memory é¢æ¿</strong> <a class="header-anchor" href="#_2-memory-é¢æ¿" aria-label="Permalink to â€œ2. Memory é¢æ¿â€">â€‹</a></h3><ul><li>æ‹æ‘„å †å¿«ç…§ï¼ˆHeap Snapshotï¼‰ï¼›</li><li>æ¯”è¾ƒä¸¤æ¬¡å¿«ç…§ï¼Œæ‰¾å‡º<strong>æ–°å¢å¯¹è±¡</strong>ï¼›</li><li>æ£€æµ‹ <strong>Detached DOM trees</strong>ï¼ˆå·²ä»æ–‡æ¡£ç§»é™¤ä½†ä»è¢« JS å¼•ç”¨çš„ DOM èŠ‚ç‚¹ï¼‰ã€‚</li></ul><p>âœ… å…¸å‹æ³„æ¼çº¿ç´¢ï¼š</p><ul><li><code>Array</code> / <code>Map</code> / <code>Set</code> æŒç»­å¢é•¿ï¼›</li><li>é—­åŒ…ä¸­æŒæœ‰å¤§å‹å¯¹è±¡ï¼›</li><li>äº‹ä»¶ç›‘å¬å™¨æœªç§»é™¤ã€‚</li></ul><hr><h3 id="_3-lighthouse" tabindex="-1">3. <strong>Lighthouse</strong> <a class="header-anchor" href="#_3-lighthouse" aria-label="Permalink to â€œ3. Lighthouseâ€">â€‹</a></h3><ul><li>è‡ªåŠ¨åŒ–å®¡è®¡ï¼šæ€§èƒ½ã€å¯è®¿é—®æ€§ã€SEOï¼›</li><li>ç»™å‡ºå…·ä½“å»ºè®®ï¼ˆå¦‚â€œç§»é™¤æœªä½¿ç”¨çš„ JSâ€ã€â€œå¯ç”¨æ–‡æœ¬å‹ç¼©â€ï¼‰ã€‚</li></ul><hr><h2 id="ä¸‰ã€å†…å­˜æ³„æ¼çš„å››å¤§ç»å…¸åœºæ™¯" tabindex="-1">ä¸‰ã€å†…å­˜æ³„æ¼çš„å››å¤§ç»å…¸åœºæ™¯ <a class="header-anchor" href="#ä¸‰ã€å†…å­˜æ³„æ¼çš„å››å¤§ç»å…¸åœºæ™¯" aria-label="Permalink to â€œä¸‰ã€å†…å­˜æ³„æ¼çš„å››å¤§ç»å…¸åœºæ™¯â€">â€‹</a></h2><h3 id="_1-æœªæ¸…ç†çš„å®šæ—¶å™¨æˆ–å›è°ƒ" tabindex="-1">1. <strong>æœªæ¸…ç†çš„å®šæ—¶å™¨æˆ–å›è°ƒ</strong> <a class="header-anchor" href="#_1-æœªæ¸…ç†çš„å®šæ—¶å™¨æˆ–å›è°ƒ" aria-label="Permalink to â€œ1. æœªæ¸…ç†çš„å®šæ—¶å™¨æˆ–å›è°ƒâ€">â€‹</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hugeData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hugeData.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// hugeData è¢«é—­åŒ…å¼•ç”¨ï¼Œæ— æ³•é‡Šæ”¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å³ä½¿ç»„ä»¶å¸è½½ï¼Œå®šæ—¶å™¨ä»åœ¨è¿è¡Œï¼</span></span></code></pre></div><p>âœ… ä¿®å¤ï¼šåœ¨é”€æ¯æ—¶æ¸…é™¤</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> timer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç»„ä»¶å¸è½½æ—¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clearInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(timer);</span></span></code></pre></div><hr><h3 id="_2-æœªç§»é™¤çš„äº‹ä»¶ç›‘å¬å™¨" tabindex="-1">2. <strong>æœªç§»é™¤çš„äº‹ä»¶ç›‘å¬å™¨</strong> <a class="header-anchor" href="#_2-æœªç§»é™¤çš„äº‹ä»¶ç›‘å¬å™¨" aria-label="Permalink to â€œ2. æœªç§»é™¤çš„äº‹ä»¶ç›‘å¬å™¨â€">â€‹</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Modal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.handleKey </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.onKey.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;keydown&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.handleKey);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // âŒ å¿˜è®°åœ¨å…³é—­æ—¶ç§»é™¤</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // destroy() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //   document.removeEventListener(&#39;keydown&#39;, this.handleKey);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>âœ… ä¿®å¤ï¼šå®ç° <code>destroy()</code> æ–¹æ³•å¹¶åœ¨é€‚å½“æ—¶æœºè°ƒç”¨ã€‚</p><hr><h3 id="_3-å…¨å±€å˜é‡æˆ–æ¨¡å—ç¼“å­˜æ— é™å¢é•¿" tabindex="-1">3. <strong>å…¨å±€å˜é‡æˆ–æ¨¡å—ç¼“å­˜æ— é™å¢é•¿</strong> <a class="header-anchor" href="#_3-å…¨å±€å˜é‡æˆ–æ¨¡å—ç¼“å­˜æ— é™å¢é•¿" aria-label="Permalink to â€œ3. å…¨å±€å˜é‡æˆ–æ¨¡å—ç¼“å­˜æ— é™å¢é•¿â€">â€‹</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// cache.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cache</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">has</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç¼“å­˜æ°¸ä¸æ¸…ç†ï¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>âœ… ä¿®å¤ï¼š</p><ul><li>ä½¿ç”¨ <strong>LRU ç¼“å­˜</strong>ï¼ˆé™åˆ¶å¤§å°ï¼‰ï¼›</li><li>æä¾› <code>clearCache()</code> æ¥å£ï¼›</li><li>ç”¨ <code>WeakMap</code> å­˜å‚¨ä¸ DOM/å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»‘å®šçš„æ•°æ®ã€‚</li></ul><hr><h3 id="_4-detached-dom-èŠ‚ç‚¹" tabindex="-1">4. <strong>Detached DOM èŠ‚ç‚¹</strong> <a class="header-anchor" href="#_4-detached-dom-èŠ‚ç‚¹" aria-label="Permalink to â€œ4. Detached DOM èŠ‚ç‚¹â€">â€‹</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> detachedDiv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;div&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> button</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">querySelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;#btn&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">button.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;click&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  detachedDiv.innerHTML </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Clicked&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é—­åŒ…å¼•ç”¨ detachedDiv</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è‹¥ button è¢«ç§»é™¤ï¼Œä½†ç›‘å¬å™¨æœªè§£ç»‘ â†’ detachedDiv æ— æ³• GC</span></span></code></pre></div><p>âœ… ä¿®å¤ï¼š</p><ul><li>ç§»é™¤å…ƒç´ å‰è§£ç»‘äº‹ä»¶ï¼›</li><li>é¿å…åœ¨é—­åŒ…ä¸­é•¿æœŸæŒæœ‰ DOM å¼•ç”¨ã€‚</li></ul><hr><h2 id="å››ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥" tabindex="-1">å››ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ <a class="header-anchor" href="#å››ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥" aria-label="Permalink to â€œå››ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥â€">â€‹</a></h2><h3 id="_1-å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œ" tabindex="-1">1. <strong>å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œ</strong> <a class="header-anchor" href="#_1-å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œ" aria-label="Permalink to â€œ1. å‡å°‘ä¸»çº¿ç¨‹å·¥ä½œâ€">â€‹</a></h3><ul><li><strong>æ‹†åˆ†é•¿ä»»åŠ¡</strong>ï¼šç”¨ <code>setTimeout</code> æˆ– <code>queueMicrotask</code> åˆ†ç‰‡ï¼›</li><li><strong>Web Workers</strong>ï¼šå°† CPU å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚åŠ å¯†ã€å›¾åƒå¤„ç†ï¼‰ç§»å‡ºä¸»çº¿ç¨‹ï¼›<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> worker</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Worker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;worker.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">worker.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">postMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data);</span></span></code></pre></div></li></ul><h3 id="_2-é«˜æ•ˆ-dom-æ“ä½œ" tabindex="-1">2. <strong>é«˜æ•ˆ DOM æ“ä½œ</strong> <a class="header-anchor" href="#_2-é«˜æ•ˆ-dom-æ“ä½œ" aria-label="Permalink to â€œ2. é«˜æ•ˆ DOM æ“ä½œâ€">â€‹</a></h3><ul><li><strong>æ‰¹é‡æ›´æ–°</strong>ï¼šç”¨ <code>DocumentFragment</code> æˆ– <code>innerHTML</code> æ›¿ä»£å¤šæ¬¡ <code>appendChild</code>ï¼›</li><li><strong>é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€</strong>ï¼š<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âŒ é”™è¯¯ï¼šè¯»å†™äº¤æ›¿è§¦å‘é‡æ’</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">el.style.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> el.offsetHeight </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;px&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… æ­£ç¡®ï¼šå…ˆè¯»ï¼Œåå†™</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> height</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> el.offsetHeight;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">el.style.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;px&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div></li></ul><h3 id="_3-æ‡’åŠ è½½ä¸ä»£ç åˆ†å‰²" tabindex="-1">3. <strong>æ‡’åŠ è½½ä¸ä»£ç åˆ†å‰²</strong> <a class="header-anchor" href="#_3-æ‡’åŠ è½½ä¸ä»£ç åˆ†å‰²" aria-label="Permalink to â€œ3. æ‡’åŠ è½½ä¸ä»£ç åˆ†å‰²â€">â€‹</a></h3><ul><li>è·¯ç”±çº§æ‡’åŠ è½½ï¼ˆReact/Vueï¼‰ï¼š<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LazyComponent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lazy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./LazyComponent&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre></div></li><li>å›¾ç‰‡/ç»„ä»¶æŒ‰éœ€åŠ è½½ï¼š<div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">img</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> loading</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;lazy&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;image.jpg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span></code></pre></div></li></ul><h3 id="_4-ç¼“å­˜ä¸å¤ç”¨" tabindex="-1">4. <strong>ç¼“å­˜ä¸å¤ç”¨</strong> <a class="header-anchor" href="#_4-ç¼“å­˜ä¸å¤ç”¨" aria-label="Permalink to â€œ4. ç¼“å­˜ä¸å¤ç”¨â€">â€‹</a></h3><ul><li>å‡½æ•°ç»“æœç¼“å­˜ï¼ˆMemoizationï¼‰ï¼š<div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> memoize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cache</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">has</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key)) cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">args));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cache.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div></li></ul><hr><h2 id="äº”ã€åƒåœ¾å›æ”¶-gc-æœºåˆ¶ç®€è¿°" tabindex="-1">äº”ã€åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æœºåˆ¶ç®€è¿° <a class="header-anchor" href="#äº”ã€åƒåœ¾å›æ”¶-gc-æœºåˆ¶ç®€è¿°" aria-label="Permalink to â€œäº”ã€åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æœºåˆ¶ç®€è¿°â€">â€‹</a></h2><p>JavaScript ä½¿ç”¨ <strong>æ ‡è®°-æ¸…é™¤ï¼ˆMark-and-Sweepï¼‰</strong> ç®—æ³•ï¼š</p><ol><li>ä»æ ¹å¯¹è±¡ï¼ˆå¦‚å…¨å±€å˜é‡ã€å½“å‰æ‰§è¡Œæ ˆï¼‰å‡ºå‘ï¼›</li><li>æ ‡è®°æ‰€æœ‰å¯è¾¾å¯¹è±¡ï¼›</li><li>æ¸…é™¤æœªæ ‡è®°å¯¹è±¡ã€‚</li></ol><blockquote><p>ğŸ’¡ <strong>å¼€å‘è€…æ— æ³•æ§åˆ¶ GC æ—¶æœº</strong>ï¼Œä½†å¯é€šè¿‡å‡å°‘å¼•ç”¨å¸®åŠ©å¼•æ“å›æ”¶ã€‚</p></blockquote><h3 id="å¼±å¼•ç”¨-weakmap-weakset" tabindex="-1">å¼±å¼•ç”¨ï¼š<code>WeakMap</code> / <code>WeakSet</code> <a class="header-anchor" href="#å¼±å¼•ç”¨-weakmap-weakset" aria-label="Permalink to â€œå¼±å¼•ç”¨ï¼šWeakMap / WeakSetâ€">â€‹</a></h3><ul><li>é”®å¿…é¡»æ˜¯å¯¹è±¡ï¼›</li><li><strong>ä¸é˜»æ­¢ GC</strong>ï¼šå½“å¯¹è±¡ä»…è¢« <code>WeakMap</code> å¼•ç”¨æ—¶ï¼Œä»å¯è¢«å›æ”¶ã€‚</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> metadata</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WeakMap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> attachMetadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  metadata.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obj, data);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å½“ obj è¢« GCï¼Œmetadata ä¸­çš„æ¡ç›®è‡ªåŠ¨æ¶ˆå¤±</span></span></code></pre></div><p>âœ… ç”¨é€”ï¼šç§æœ‰æ•°æ®å­˜å‚¨ã€DOM å…ƒç´ å…³è”æ•°æ®ã€ç¼“å­˜ï¼ˆé¿å…å†…å­˜æ³„æ¼ï¼‰ã€‚</p><hr><h2 id="å…­ã€é˜²æŠ–-debounce-ä¸èŠ‚æµ-throttle" tabindex="-1">å…­ã€é˜²æŠ–ï¼ˆDebounceï¼‰ä¸èŠ‚æµï¼ˆThrottleï¼‰ <a class="header-anchor" href="#å…­ã€é˜²æŠ–-debounce-ä¸èŠ‚æµ-throttle" aria-label="Permalink to â€œå…­ã€é˜²æŠ–ï¼ˆDebounceï¼‰ä¸èŠ‚æµï¼ˆThrottleï¼‰â€">â€‹</a></h2><h3 id="é˜²æŠ–-é«˜é¢‘äº‹ä»¶åœæ­¢åæ‰æ‰§è¡Œ" tabindex="-1">é˜²æŠ–ï¼šé«˜é¢‘äº‹ä»¶åœæ­¢åæ‰æ‰§è¡Œ <a class="header-anchor" href="#é˜²æŠ–-é«˜é¢‘äº‹ä»¶åœæ­¢åæ‰æ‰§è¡Œ" aria-label="Permalink to â€œé˜²æŠ–ï¼šé«˜é¢‘äº‹ä»¶åœæ­¢åæ‰æ‰§è¡Œâ€">â€‹</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> debounce</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">delay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> timeoutId;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    clearTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(timeoutId);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    timeoutId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fn.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args), delay);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;resize&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debounce</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(handleResize, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">300</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre></div><h3 id="èŠ‚æµ-å›ºå®šé—´éš”æœ€å¤šæ‰§è¡Œä¸€æ¬¡" tabindex="-1">èŠ‚æµï¼šå›ºå®šé—´éš”æœ€å¤šæ‰§è¡Œä¸€æ¬¡ <a class="header-anchor" href="#èŠ‚æµ-å›ºå®šé—´éš”æœ€å¤šæ‰§è¡Œä¸€æ¬¡" aria-label="Permalink to â€œèŠ‚æµï¼šå›ºå®šé—´éš”æœ€å¤šæ‰§è¡Œä¸€æ¬¡â€">â€‹</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> throttle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">limit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> inThrottle;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inThrottle) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      fn.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      inThrottle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> inThrottle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, limit);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;scroll&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">throttle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(trackScroll, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre></div><blockquote><p>âœ… ç”¨äº <code>resize</code>ã€<code>scroll</code>ã€<code>input</code> ç­‰é«˜é¢‘äº‹ä»¶ï¼Œå‡å°‘ CPU å‹åŠ›ã€‚</p></blockquote><hr><h2 id="æœ€ä½³å®è·µ" tabindex="-1">æœ€ä½³å®è·µ <a class="header-anchor" href="#æœ€ä½³å®è·µ" aria-label="Permalink to â€œæœ€ä½³å®è·µâ€">â€‹</a></h2><p>âœ… <strong>å…ˆæµ‹é‡ï¼Œå†ä¼˜åŒ–</strong>â€”â€”ç”¨ Performance/Memory é¢æ¿å®šä½é—®é¢˜ï¼›<br> âœ… <strong>åŠæ—¶æ¸…ç†èµ„æº</strong>ï¼šå®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬å™¨ã€è®¢é˜…ï¼›<br> âœ… <strong>é¿å…å…¨å±€ç¼“å­˜æ— é™å¢é•¿</strong>ï¼Œä½¿ç”¨ <code>WeakMap</code> æˆ– LRU ç­–ç•¥ï¼›<br> âœ… <strong>å°†é‡è®¡ç®—ç§»è‡³ Web Worker</strong>ï¼›<br> âœ… <strong>ç”¨é˜²æŠ–/èŠ‚æµæ§åˆ¶é«˜é¢‘äº‹ä»¶</strong>ï¼›<br> âœ… <strong>ç†è§£ GC åŸç†ï¼Œä½†ä¸ä¾èµ–æ‰‹åŠ¨å¹²é¢„</strong>ã€‚</p><hr><p>âœ… æœ¬ç¯‡äº®ç‚¹ï¼š</p><ul><li>å°†å†…å­˜æ³„æ¼å½’çº³ä¸ºå››å¤§å…¸å‹åœºæ™¯ï¼Œæä¾›å¯å¤ç°ä»£ç ä¸ä¿®å¤æ–¹æ¡ˆï¼›</li><li>å¼ºè°ƒâ€œå…ˆæµ‹é‡å†ä¼˜åŒ–â€çš„å·¥ç¨‹æ€ç»´ï¼›</li><li>ä»‹ç» <code>WeakMap</code> åœ¨å†…å­˜å®‰å…¨ä¸­çš„ç‹¬ç‰¹ä»·å€¼ï¼›</li><li>æä¾›é˜²æŠ–/èŠ‚æµçš„ç”Ÿäº§çº§å®ç°ï¼›</li><li>å…³è” Web Workersã€ä»£ç åˆ†å‰²ç­‰ç°ä»£ä¼˜åŒ–æ‰‹æ®µã€‚</li></ul>`,72)])])}const o=i(h,[["render",t]]);export{g as __pageData,o as default};
